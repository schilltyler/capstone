---

excalidraw-plugin: parsed
tags: [excalidraw]

---
==⚠  Switch to EXCALIDRAW VIEW in the MORE OPTIONS menu of this document. ⚠== You can decompress Drawing data with the command palette: 'Decompress current Excalidraw file'. For more info check in plugin settings under 'Saving'


# Excalidraw Data

## Text Elements
ch0nky_proxy ^IZvCMU2a

ch0nky_app ^9tVDwbg0

/tmp/ch0nky.sock
 ^rJ8RMp6A

Payload stages ^dtIjQnRQ

stage 1
- inject shellcode payload into ch0nky_proxy
- shellcode is likely an ELF with a loader attatched
- payload has a second stage:
 
stage 2: 
- stage 1 ptraces ch0nky_app from inside ch0nky_proxy
- stage 1 injects stage_2 into ch0nky_app
- stage 2 can now read the contents of /mnt/jail/app_user

Question: how does stage_2 egress?
- app_user cannot access the network
- proxy_user cannot access /mnt/jail/app_user

Approach #1
- inject shared object into ch0nky_app
- every 30 seconds, it copies the contents  /mnt/jail/app_user
recursively to a globally readable location 
- ch0nky_proxy can then read the contents, and delete as needed 
 ^zFmwC60x

Copy payload: ^A0bFwhY5

inject payload  ^O2T5GlGU

aarch64-linux-gnu-gcc  -Iinc -fPIC  -shared -O1    src/copy_payload.c  -o bin/libcopier.so
 ^Mq8p5jHN

copy payload is a shared object injected into the app_user process  ^BOagW7ot

%%
## Drawing
```compressed-json
N4KAkARALgngDgUwgLgAQQQDwMYEMA2AlgCYBOuA7hADTgQBuCpAzoQPYB2KqATLZMzYBXUtiRoIACyhQ4zZAHoFAc0JRJQgEYA6bGwC2CgF7N6hbEcK4OCtptbErHALRY8RMpWdx8Q1TdIEfARcZgRmBShcZQUebQB2bQBWGjoghH0EDihmbgBtcDBQMBKIEm4IADUAFQAOACkAfQBONgA5erZ650J6fApqgCV4gEEAaVSSyFhECsDsKI5lYMnS

zG5nAGYARm3+UpgNzfiABgTa7Z4k/cgKEnVuHhPrwshJBEJlaW5t5pepiDWZbiVAnG4QZhQUhsADWCAAwmx8GxSBUAMTbBCYzGrSCaXDYGHKaFCDjERHI1ESKHWZhwXCBbK4iAAM0I+HwAGVYCsJIIPMzIdC4QB1e6SR7goWwhDcmC89D88rgklfDjhXJoPavCBsenYNSHLUnME64nCOAASWImtQeQAuuCWeRMtbuBwhBzwYQyVgKrgTsySWT1cx

bcUATMQZtXgBfKUIBDEH6bZoAFmO8SSWfBjBY7C4aE2fB1edYnDanDE3CStQAbPWTjw/t7mAARdJQJPcFkEMLgzTCMkAUWCmWytoKUyKr1K5Qk9AozBGAEUAFYADWwm3w8O2AEc25UAAqNEbMeKaXGlKP+0jQqiz2OvR06oRwYi4LvJrXxNNpnhtmzWo0ySX5wSIDgYXdT18AgthCW7NBe3wMJCnjQoI0ged0EtAAteh4QAWQAVR4XBmVvaksCgZ

l1jQZweDrf4Dg2HhakSeILiucE7mIB4tU2TZtB4eJmlqZpfjreIZM2f9wXeT5vjQHidSBBVTQBaU4QpFF0WxLEkAHAkiWDckkT06lyA4OkGSyWinXZLkeRBCEkWVHVtIQMV+IlFSpShGU5QVNyBRVYQ1Q1H5wT1AlDR+E1wXNd9rUnV8AWdXBXR/VAPS9HUfWIP0JFwbYgyHYhQ1tPK4M8xMcuONMJJOOSWMgMsCx+NqGCYcsOErDhqy1P4Tg45j

am6wh207JDUBQ/sdUHUliFHDJ7LS8F30/b8fj/ACgKzbZxogn1oLQGr4MQnL5oQcEu0wWiJGwSQTigmBGjgaFMEOFVKGqGiKme16YXez62G+5kWU4KBOUIIwQSeJ1oYAMSy9kjVQbr7qgEYiGUQt0GCFkHNLJgoHMAhcc+AnoD1Zk9GyXAfSYN1ztgmLSE+H0CH+h7AZet6Pq+n61KEKA2EGcI4ZBKEhFunVIIQAAJD4vke1BthEpJ0P2LCyhyiB

qhZIQxhIkZ4VwGFamIAB5OA2yIyR933G26wmO74Fc+ZFmBOifm2TZwQx5xfk1rjLm6viBI1lsdUUtWflA8F1JBTTSi83SqXQDFDJxYzCWSslM4qGkbPpRkSYypzgtcpVkwC4VvPFSVPMCuEa4qOvyr8SQquinVYoNWAErTyBkqtG18nS0pMuymD8oBQrivQXAeG7kMorQLDpk97gYymDCtPqx5mhOLNRu1AEOs4Xbuuv/qqxBZiz5k7N4lbDtgh2

5C+3lgElpHGOda+RZzb2wgbRcy51xbh3HuQ8J4zwXivDcG8u8Sr3jYI+acz4pjT0gFtL8s1th7UArWE4dYGyX1KJBM6uV2YKwQnCa6v8daYQKgbZoUBKhtgoJoZQgYPazGonzcE9ENapiDhsbYaYzjh1UgCKOfkNYB20AHZop8uKbDrJJGRdYFKq2UrwbqKduCjwhG3BEFks4QBzgZZk+IC5mWLlZWk5d7KQ2ri5Tu7l66t0bj5aOJYtIWI7nyHx

3dIphn7gCQe8VjRmPHqlKeToXQIFZnQhec5fRiMBJsdelVN4ZNqkfIhTF4hCTTNsCauZeqdTQBJGp+YKyPxTNI54p80zvwKtNL+s0boDgqqtccORklvg/IQnKxD/ykNqC1aSeiFanXnsU6hjC+m/zugDJ6AsQaNFwHAOAQY/pbPQEDQW+zDlI2yLDeGjwzFQ2yKjfQ6MaybIelTfGFQiaV1KHmcm7gPk03FpcnUDMojM1IOki6A9Ob+B5iciAZzd

kXOZLgMWEspa3LQLLP+1DmYqyUurTWVxWElD1jhBgS5Vybm3LuA8R5TznkvJRNBK8MFUFEVI54kiGKiTiCaCOvFm4qWIfowlPw6xxCeOxGRlw6xNh2LUZOSwNINxlM47OBk86LRMoXcylIS7WVshXDxHJQmKnCWq0UwreBWtlF4sJYUdSql7oUqhkBYnD3iUlEkE8No6lnmknK0LF7ZP9GmfJfct6zmgKyngcYEyzTKUkJImwJJ31qTfFS9ZGl9Q

GkNDWsyjqgSau6soPSEDfzmhsxagygEThAdOMBsahHoGxtecBcx6i1EGEROAdYRgQCfC+Ta4yq1TP2mQ6SObFlQWWZdJhPYa0AjgGwH0Iy0BTimFuqYo8SgnFnHgsAO6SjNGErsE0l6r0CpQWAM9qjtjXqfdsQ9KCT1gEAl06cYAjpSqbCBE4cqFVVMPSOhWoQoCIn0M8mQSZjxrqZGzTJAgoikCgAAIUKj6ZQ3Bt4YHrVAdJVQ6hNFaB0LoPQ+g

DGGOMa8rIEJCFtM4M4YEL1Pqve6se+zolV0wHBhD6saoJp1FkYgmGyTYdwzG9IwyiNGxNmbC2Vtbb20ds7V27sY1Q2wIxjYLGX4nGaNopspweBpq/QCZQ3GtQoNZIQPjxB4PruWcJ4JDIcbsveLgYN9CASiZGJ5kIBsGQPmZEEQcFB1moQQKSmci8DakG7b2/tg7BGuXbZyhizREiSXUWfHgTEkiSrTM0HlqBGItW0BJQVOpFG7X5UkcS0jQI7Hk

aUeOhikhmJMWgMxGcrH6VzkZHVjiKoaugEatxTJHJmodRap1wT/E2qCenEJc3QoeQBC6qNGsYr6jiRrRKZpfVJM3Xg1kqSoW+ayUVHJuAUjhWWjtkN6dj5oDrJ0pIGZJKB1Jk0gmgFc0FnzSCXYdYqm1DM2Wqan9K1RYWv/Ota0G1ndHdtIhJCgKzKeLsE6c6kMrMgMiK6S7otvPVhASI+g4AKCRTAbQghCQAB0uC/QGAiqnNO6cM8YSzyG0MbkI

3uSjNG+AMZYxooCwG9kmDMj+RTfAUuJDPOIMQFY4IwVM3VJCiBVLoG0rgQyxBzKOZcw4PCvmEhOe052fTxnMI+fJ3RZLVgWLUA4rx8rAxRKtaxfJQbTApAeBplIPQeouAxjockMxignI1zxFIPCZwbYWWtogN7ExmXyun26sHY4zRzg1YUct2sYqE7veMSq1Odrxu2MMvY3VTiBsuLLnZabAbPHylrpavxMoAlKJWyhxu5qNu+K2xFV1USbMD321

6w7CSTuT1RwGy7PnkNlDDSVOskbCl4aoqgfeJRD6vaIamWokPRLg6B1m+f1+H6DQRscYsdZjiTQrVW/ptblpDOAcvgEBDx1Mdaxg94gzM8daEXsic1lmFos/d2EKh+JLQ1wVwOBBgVxU90sAYs9nAOIy089JVC82tbgbUgIzhpJxJTh5UvsGwcw45vdHhK9fZesa9m9NUhsG9RtlpxtS5jV3EZtnIu9vEFtVsltfIW5Fsgp1su5HtIlbQy1PUMZH

0F8LRTs7RztA0rt18l47t4gd8p8ilE0cp5VAIft1E79do78Qcfhz9dhOkMxod394dcU8Qkdhl/V/8x0MdpksdAIKELMiclkCcF0nDycKhjxcB5Q2BvNUBIRohwgjl2dLd0BwjIjojYjlB4irkYZpY7ksinkXk0AJd3k8YaZvk5cyYFclc206YNdoYtcWY19CddRYVuZ8BeYKcUjkQ0iogMjcgndxYXccjsVSA5ZPcCVy8NZfcj9dZ4CJAjBkZ9AK

B4R5V1g0sS4sCdQxFnBstNZpFLh4hdgjMwc8C2IutzhaxpEjNz8TMhUxCK8khkhUwAJcDDNX8y9OsjsAQetQQWCDUJA69tV/5G8xtWCJtXE28flIA2RZtBDHVNsRC+9ls7UR9pDnUJ8dt5DZ9FDPjShEkl81CUksog150CpN8V5ag9DqprsBA3tMZ4hJVZJqk/s+puA8tLCWktQA4LgKFmhmwP4ZoYCEdSgAEVoCN3DSgACvCPsWsTRAIlVZ0IDq

SIBidF0f4ycdR20+QeiEANYWdnBUAfQ1wEAFgYj3gOQ9AipUB6RUjiADTsg2BUA6chZwYYA9TTSgh8ALSdSppUAiA4QxdUBrBUBhwAAZZGVAO4dQQM30qIoqUgQMmQL8Z6JMN060ro20yQUIaMsIBmW09IhAZAFnVAFnfM3gNAN00s7YK0mkMQZgR023PZA5OaaEfQO0hwHUp0sGb6Cs7UjWO0o0hYOs/MxoHgO08Wes4Gd6C5HsuI3gR0oMjgTB

VAQIaI9QDs6GdaVANgFkVABQfQbIBQNcJmfABQC5RoRjJgFnFnFcOWSEAsNASQJc4gNgcIGI7Ukc1ABAYkDUAAfjdLPIvPjLwA4EXKgEDOwFrLrLXNykrQoBRAdxcCtOFnPLCCAusFAvAsgt3P3KgEPOPNPIORQsvI4BZxGAOWhAJEkFQAxDdMNONLAuYEzMCFtLsAHLAvXQdKdOnMQoQDzBgAPxOBiONM4BtGoANLAr0DgEIFfOgrBU3OwoPKPP

ZAIrgCItIBZ3mBEFYEYADPHNwFQGWDsAIADJXM/E0GCBjLwHJk4GLMQs7OFnnI4Hd3eCctMucvXOyHWjEusFtKKl6UDLrPVCTCTFsoSPaM7l7O2Foo4DYvdPNLYEtLTNjLHM4obK7NdMQsYo9K9INLrL9KCH4qDNDPDMjKov0vTKYATKiCgGTOIFTIiPTNQEzLrP0pzJErfLiMLKcpLN7J4HLMysiurPIFrInPOSbOdAMDbJIA7LSuFhnIyL7Los

HI6oyI/I4tGuRQOXmp1NHOAtyiXLctko3InC3J3L3MUvwoAtQqvI4BvPCGso4AfKfJfKHPfNHK/MCDDD/MQqusquAowoJCwugvVCgDgtIAQv1PSrUscoBogo1AUtwqUpPN+vUpIo4DIrBkouoqisQqWoYqYpCtYvopSo2qnK2p4r4oEqEtzOYDErUEdL1GkqgveAZs8pOoRrwuUpRo0uNK0t6AKvdwdP0sMvxA5H4tMtwHMp1OJy/ALFsv1PspdM

cvctcqC3ctZq7AnG8rJFQD8rhwCpguCttMdwDQFyGN4GF0eVF3F3JyqOVIQGJnKLQ0qJKJLhqNBTqIhU0KaJRDNwtwp0rOitiqyvisSoauSvWsVu7MyrNM9ISu9LysIH9MKqcuKojLUDKpjO80qq/GqtqvqptKaqzNauEp1vzK6tstLL6vlpWp1KrLgBrNfK4vGpbKmstKjoyv1MrP7PoteriLWvtNJsbLgG2rnL2sXIoGXLVqOrZpyFOo5qRpUr

UpururvM4CesnufNfOHPeu/K+v/MIsAphrYDAsBvhuBtgvgtTOQqPv+pPswvhvOsRsusPuurRoxoouemxqDuJsYrshYs0FisjobO4v1N4qYH4s2EErarJFpvEoZqkpkpZrkvZqfs5uRtfuIs0vzB0v4r0oMuRFFpMqC0losploepro7uVrXNVtXOQeOpyG1t8pmgNqCqKmNtZ1FgGMxRlhGOcOVPxXoK1CmLAGP39wqE0EkGqBhGwHhB4CMDTH0G

aBgBGHhnwGUH0CVmYHwAwLmHosz02I2AuBOKLFOBEiqVoOLzuN4HAjoPFU5NKzUir1MV+MsjYLsXzlMhBL+LbUmwhNNQEJClRIkOtWscH3MWHykJ73Hx7gxL2zijnyUJ9RUPxIdEJLniCNJNu39GaEpKk2nBbWjFcxP0mRAlkmzAzX+12jTHZIf0TiqV+F5PKX5N6UFP4ZFJ/xRwJLGXR0mUxwbE2C+y0XAJJIBBVKcLgPiwqBGBOE0GRgoEkAAE

0HsNTWVoANiAQtiZJwmMZKk0xzGOJI4SDixVExJz9awPsrguJ3j1YiDARnHmDe8dJQSAThsgTOCi5QSeCptIS7MYSgnomETQnAlkSonhDIBts3V4mh5sTlCUpUn1DV9Rmbtl5ARUs0SntClICIRaSql2J8sz5zD3t/Cep/srCtRZkAJngb1ulYcP9l1hTXDf9umPDenqn9oBmhmFkxnAiDCGESc1ShTpgEVEQ4B+KkrvNkAwqRW9RxXw7JX+drlz

bEZTarbnkxdXkNTJdXaJAyjGl/lKYdXqiQUARNcvbGjTc4U2iZWxWrT5XiApX+iMVXdeHRjZ0vd7HJiSVpi2EpmJBmgKARRk8QzJAKBlAiJCMYA2xJBjxMAiJCAeBCBdGJAM9nHsDKWytg8zg5TLHSg6sVIWobnuBJVlUmCfinnLEfGbEtU3nhTgSuCvm/GTV+CUTAWh9ESwnQXYT5t4SIX0SoWZ8EnYXkn4XxSoSkXMnQ1smSp0M8no0Cn99D9R

HDCfhg8wdstpIiXUAS3mTgcOTeAGx5UWpJIWm4c2mBlv8xTRlWWJl2XfCLgz50wRnJ3VkBXq1YCfWyVZj0AbYeBqgkgABxfAADkiZNttDZtYDYekkxg94lCxo56x6ROIC4cSbRdRVjUAotlSRg1VCt2vGtjgrxhtqt75/xltsF3tiJjtkFit1t8F9Pft/QzEodkeEdv1a9meCdvlqd1F3AeEOd7jkp6pqBiaUOLduSWpgtZqM9bMWxxeRw89r/QB

ZHDdFliUzwvp7whsJ4MCGphU5FqAt9z/SMBFPGu1wu6VpIjfWKiV20xV7It3FVjKEXdVm2rV4o6mL5B235+XAFI12mE10oM17Xb2y11o8KiQMz2z9AJ1wYt3D3d18YwxYlbWT9uLOcA2IifcWoOAJINcJWNoMD9ZkRQxhiIrbl1iNAACOsA53N4g6x+sfZ5sXLDMQZs9OrqQIRzGbrB58tkJyttx6t9gzxvVbgptvgjvf57vejryfvcQoF+1bt0f

CJSfOQ6Fg7JJ47FJsdi7Ik0LrJ3jlPR7DefQ7FsIIhE4ErAVMCX7K+TNAmPTu7sl/dorchVNGl+TulkIpT0UlTnbyUzTjliScgx7vFfHQTwz1U99oV4rinXABkZ6D7ZwSCIQTAZwfGIQdHiC1AcrS0H0bAcrFkY8S0eEHH5wP+5i8rG2KsnHmI0QWnWVj6e13QMnh0zQH0BQIgTQSS6S0gHnE2rbY5Kz+H0QSQJHlHtHjHrHgn3H/Hwn4n0n8rCn

kK5wan2nun7ABnsVpnm0ln8rNnjnrnnnpgfnzh5zpVxzy2qAfIjVwo22/zvVv7A1xXfz4FemT2kLi1mFP2614XhHsXtMZHn0VH9Hj0aXsnvHwaeXknsn5X201XmnnH5genyS0GZnmX5wA3mwI3xmk3wQAX0oNFbhl17gBLnl9UJLn3b15d31jLiodDG2aIEUeIE+orjLUr8rLiCryAcXY4WrhD6OChB4sSdMNNTpZiSVbqDrW5nD6vPDl5gjkbpv

Ej8b9vKuKboQyj2bpE2jijsfUoSFpj9bxJnEseRfHbjQr3nju7YcATs73FiSU+Z+HYLdy4Mxe+clw7S4g6MCU9+l9UxHJez+4cd8EGnO9kdF5Lpgn2+nF9pD2+4mcrOqfczo1R9KtUCaADIBjFXoohV1q0FFGkhQQjw1LOFOJAdF1QGml/6W5QBsTTxo4DB6eAzBvGTBhYV7OguXIqq2t7W1NWCAnGA7285O1nedtN3rUUZjmsDOzRH3hF1OSytk

BEdFqhQMp5E0TStA20rgJZr4DmBRA2Ljw1L58MxiXXFLpMzr4SARgIZaoDwEwAcB6AqxVZmnnb6bM2IEkOIA2FTSiR0wf4F/jqGDgmFEg0iSHKcDURIdbi0ceUgCGn4MFS2uHfrvh2G4jYiOnzFfuCWbaTdAm03LfhYjm7+Rd+S3YJgf0Y5rdB2MLVjlt1HYgDduGTCHhvmnYrxkYd/JUud0mRaI+UkqCRLuxvy3dfk93T/oBG/5lIHCX3HKGX0Z

ZAC3C4ggHtU2lLvd0wTUZ9pUPGaKceBFQYgUsKyJsCC2eRLgXb3c68DPOurfgfqxdq7DjW7vUQZ73EG+0rWUgiAKimdw6Dhibrcvh6wmKGCj84AdKICAOTchCE+TaYO8EyAIEGQ0EfYAwGkoUB0M9bBIYNzRAsgYRsI1YIihEAVxLQXYfQNyEbgxCPGhQBEfeHsjIiMg4Ij5vqkG6kdkhQXREbiJRHIxO8ALYQtiKREoi0R1HAfMCJ0w4jsgeI1E

WthyGAs6RFIjIIMHyE8ZeR7IlEXbBY7eosRrI+kRkGRgucCimMFkeSJFEyizalvRUWyMIwoj2idtR3mSI1EcivhaGALA+C8xX9IAUovkfoGHBkhjRmCU0XeFCzqjpR+gW0QMDWZmR4RzAbANCA5Abg945BVRPWC6w7BD22YYEV6J9H4BFmjwczAkHYiXBT4LUesCtggBGA2ABgH4e1AIBywfgqiOZAVlizCjNR/IiqDtgY7LR4RxIEgGsItrAiqx

xAbkAgEORbDcSnMYgERHjrWjSG8As/iQA1R6x0MSIBLMoHxAAAKT9GJQnE2N34oIZIAAEpmQksZQJ6AZBzARxuAccVA0nFbjeAO4ljAuMLEWjrkFiO2A9SpKZJyhCASWL6E5hLBMxGAc3FLUGF6DQURAZse7hfEAhzc/w+4fw2EBQBFYuguWIWKUE5BOQ5uOAB2KKhdinxpOIUoCAWD81qg6YnRvO1QRp4wgwQRCTfA1yMZxY+gaoKymxbzC4J/D

fABBhGCITGAyEpEC5leE18oS7IeIlvGfCxggAA==
```
%%