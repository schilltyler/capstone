
## Basic Rubric 
Subject to change but only to help (i.e. more opportunities for bonus points )
- Just because something isn't listed in the rubric, doesn't mean it isn't required. I.e, if rubric has task X and  a pre-requisite is Y, then you must complete Y



# Core Requirements 
- you are should avoid writing executable files to disk where possible
- your implant needs to be available for multiple exploitation scenarios: 
	- 1) elf binary executable
	- 2) shared object 
		- support for main payload in the .init array
		- main payload in an exported function
	- 3) HARD: position independent shell code

| **Section**                                                      | **Task/Requirement**                                                                                        | **Points**            | **Notes**                                                                                                                                                                                                                    |
| ---------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------- | --------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **I. Implant Base Functionality (50 Points)**                    | **File IO in Chunks**                                                                                       | **10 Points**         | Upload/download files.                                                                                                                                                                                                       |
|                                                                  | - Chunking & Transfer                                                                                       | 4                     | Splits a large (1GB+) file into manageable chunks and reliably transmits them over the C2 channel without writing additional files or reading the whole file into memory (mmap is ok).                                       |
|                                                                  | - Error Handling & Resumption                                                                               | 3                     | Gracefully handles network interruptions and ensures proper reassembly on the c2.                                                                                                                                            |
|                                                                  | - Performance & Efficiency                                                                                  | 3                     | Optimizes resource usage and provides clear logging/status feedback (i.e. 10 chunks / 100 chunks recieved)                                                                                                                   |
|                                                                  | **Process Migration via Injection**                                                                         | **10 Points**         | You are in Process A: You want to be in Process B:                                                                                                                                                                           |
|                                                                  | - Target Process Selection                                                                                  | 3                     | Accurately identifies a viable target process using process enumeration and verification. I.e. If you are not root, which you may or may not be, you can't  just inject into any process                                     |
|                                                                  | - Injection Technique                                                                                       | 4                     | Uses approved Linux injection methods (e.g., `ptrace`) to migrate the implant.                                                                                                                                               |
|                                                                  | - Stealth & Cleanup                                                                                         | 3                     | Ensures the original process is handled appropriately with minimal forensic footprints.                                                                                                                                      |
|                                                                  | **Persistence**                                                                                             | **10 Points**         | Can you service reboots/process failures?                                                                                                                                                                                    |
|                                                                  | - Implementation                                                                                            | 5                     | Uses at least one Linux‑appropriate persistence method (systemd service, cron job, startup script, etc.).                                                                                                                    |
|                                                                  | - Robustness & Stealth                                                                                      | 5                     | Persists across reboots while minimizing detection. This also means you should not have unnecessary copies of your implant running. i.e. cron job that runs every 5 minutes and spawns  dozens of connections is not OK      |
|                                                                  | **Long‑Running Task Spawning**                                                                              | **10 Points**         | (i.e. spawn a shell and redirect IO to the c2)                                                                                                                                                                               |
|                                                                  | - Independent Task Creation                                                                                 | 5                     | Spawns background tasks (via threads, fork, or separate processes) that run independently of the main implant process.                                                                                                       |
|                                                                  | - Task Management                                                                                           | 5                     | Manages tasks with proper signal handling, cleanup, and stability over extended periods.                                                                                                                                     |
|                                                                  | **PLT Hooking & Remote Process Introspection**                                                              | **10 Points**         | One of the hints I will give you for the final sandbox, is there is a target application that receives "flags" at regular intervals. Your job is to hook the function that receives them, without interrupting the function. |
|                                                                  | - PLT Hooking                                                                                               | 5                     | Implements code injection where the final payload installs a  PLT hook (or equivalent  method) to intercept function/system calls in a remote process.                                                                       |
|                                                                  | - Introspection                                                                                             | 5                     | Gathers and reports runtime data from the hooked process (e.g., parameters of critical functions).                                                                                                                           |
| **II. Communication & Cryptography (20 Points)**                 | **Dual Communication Channels**                                                                             | **10 Points**         |                                                                                                                                                                                                                              |
|                                                                  | - Low‑Latency Channel (TCP/TLS)                                                                             | 5                     | Provides a dedicated channel for real‑time command/control using TCP with TLS.                                                                                                                                               |
|                                                                  | - High‑Latency Channel (HTTPS)                                                                              | 5                     | Uses HTTPS for bulk or less time‑critical communications.                                                                                                                                                                    |
|                                                                  | **Secure Session Establishment & Cryptography**                                                             | **10 Points**         |                                                                                                                                                                                                                              |
|                                                                  | - Protocol on Top of TLS                                                                                    | 6                     | Implements a secure protocol (using libsodium or Tink recommended) on top of TLS for session securing sessions                                                                                                               |
|                                                                  | - Key Management & Handshake                                                                                | 4                     | Successfully negotiates session keys and exchanges credentials securely. It is OK to hardcode public keys/PAKE but not symmetric keys                                                                                        |
| **III. Special Instance Adaptability (20 Points)**               | **Environment Adaptation**                                                                                  | **10 Points**         | 2 weeks before the final project, you will get a VM image that fell off a truck. It is your job to analyze the VM and build a capability tailored for this target                                                            |
|                                                                  | - Adaptation to Non‑Standard Environment                                                                    | 10                    | Adjusts to a provided VM image with a non‑standard Linux environment (custom libraries, system paths, sandbox constraints).                                                                                                  |
|                                                                  | **Sandbox Bypass / Flexible Operation**                                                                     | **10 Points**         |                                                                                                                                                                                                                              |
|                                                                  | - Overcoming Sandbox Restrictions                                                                           | 10                    | Implement a solutions to operate fully within the provided sandbox, with supporting evidence (logs, screenshots, tests). This will be tested during the demo                                                                 |
| **IV. Code Quality, Documentation & Build (10 Points)**          | **Code Quality**                                                                                            | **5 Points**          | Please, Please please: document your code. Use sane Variable names. Do not submit something that is a 1000 line function.                                                                                                    |
|                                                                  | - Modularity, concise functions, and clear comments                                                         | 5                     | Follows best practices (functions ideally under 50 lines, well-organized source files).                                                                                                                                      |
|                                                                  | **Documentation & Build Instructions**                                                                      | **3 Points**          |                                                                                                                                                                                                                              |
|                                                                  | - Comprehensive README, build scripts, and module descriptions                                              | 3                     | Explains how to build, deploy, and test the implant.                                                                                                                                                                         |
|                                                                  | **Build Compatibility**                                                                                     | **2 Points**          |                                                                                                                                                                                                                              |
|                                                                  | - Must compile and run on an aarch64 Linux sandbox. The build environment will be the course rasperry pi 5. | 2                     | Acceptable languages: Rust (no_std/core/alloc), Zig, C, or C++ (compatible with the Pi sandbox environment).                                                                                                                 |
| **V. Extra Credit, Opsec & Special Feature (10 Points or more)** | **Opsec Enhancements**                                                                                      | **5 Points**          |                                                                                                                                                                                                                              |
|                                                                  | - Additional obfuscation, encrypted configuration, and minimizing implant size                              | 5                     | Extra security measures; note implant size penalties: >1 MB: -5%, >5 MB: -10% (binaries larger than 5 MB are disallowed).                                                                                                    |
|                                                                  | **Special Feature (Student-Chosen)**                                                                        | **20 Points**         | While it is  purely bonus points, it is a requirement. If you don't implement a special feature, you will not pass the final project.                                                                                        |
|                                                                  | - Approved special feature (e.g., steganography in C2, alternative C2 channels like DNS/QUIC/WebRTC, etc.)  |                       | Must be pre‑approved by the professor; can earn extra credit or an automatic A if exceptionally innovative.                                                                                                                  |
| **VI. C2 Server Requirements**                                   | **Multiple Operator Support & Audit Trail**                                                                 | up to 20 bonus points | Supports simultaneous operator connections; maintains an audit log of commands (which operator issued each command) and responses, while handling both communication channels (TCP/TLS and HTTPS).                           |

---

### **Additional Submission Notes**

- **Demonstrations:**
    - Provide evidence (live or recorded) showing file uploads (with chunking), process migration/injection, persistence, long‑running task management, PLT hooking, secure session establishment, and operation within the special VM environment.
- **Documentation:**
    - Include clear build instructions, a README, and detailed descriptions of each module and third‑party libraries used.
- **Testing & Compatibility:**
    - Ensure the binary meets the size constraints and compiles on an aarch64 Linux system.

---

This table offers a clear, at-a-glance overview of the requirements and point breakdown for your project. Good luck with your implementation and special feature proposals!


## Foot Guns

- **Foot Guns** are critical pitfalls that can significantly reduce your overall grade if not addressed.
- **Ensure:**
    - Your server is robust and secure.
    - The build process is straightforward (provide a Makefile and configuration file).
    - Your implant avoids obvious debug strings.
    - The binary size remains within acceptable limits.
    - Debug symbols are stripped.
    - The C2 server has proper authentication.
    - The implant runs stably during the demo.

| **Foot Gun Issue**                     | **Penalty**                  | **Notes**                                                                                                                                                               |
| -------------------------------------- | ---------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Easy Server Hacking**                | -10%                         | If the C2 server can be compromised in 10 minutes or less, you will lose 10% of your overall grade.                                                                     |
| **Overly Complex Build Process**       | -10%                         | If it takes more than 5 minutes to figure out how to build your server, client, and implant (i.e., lacking a clear Makefile and configuration file), you will lose 10%. |
| **Egregious Debug Strings in Implant** | -10%                         | Hardcoded or obvious strings (e.g., `"do_process_inject"`, `"spawn_reverse_shell"`,`https://my_c2.evil.com` etc.) in your implant will incur a 10% penalty.             |
| **Excessive Binary Size (>1MB)**       | -5% (additional -5% if >5MB) | Binaries exceeding 1 MB incur a 5% penalty. If the binary is larger than 5 MB, an additional 5% is deducted. Binaries larger than 5 MB are not acceptable.              |
| **Binary Built with Debug Symbols**    | -5%                          | Launching a binary that includes debug symbols will incur a 5% penalty.                                                                                                 |
| **C2 Server Lacks Authentication**     | -10%                         | If your C2 server does not implement authentication for operator connections, a 10% penalty is applied.                                                                 |
| **Implant Crashes During Demo**        | -5% per retry                | Each crash during the demo incurs a 5% penalty. Additionally, if a crash generates a core dump (the system is set up to catch segfaults), an extra 5% will be deducted. |

