**Malware Analysis Lab: Reverse Engineering a Simple RAT**  
**Objective**: Analyze a suspicious binary using Ghidra to identify Indicators of Compromise (IOCs) and determine its functionality.  

---

** do not run the binary **
---
### **Lab Setup**  
1. **Sample Provided**: `sample.tar.gz`   
2. **Tools**:  
   - Ghidra (for static analysis)  
   - `strings` utility  
   - `objdump/readelf`

---

### **Part 1: Basic Static Analysis**  
**Task 1: Generate IOCs**  
1. Calculate the SHA256 hash of the binary:  
   ```bash
   sha256sum sample
   ```  
2. Run `strings` command and look for:  
   - Hardcoded IPs/domains  
   - Suspicious  library functions  
   - Other suspicious strings 

**Questions**:  
- What domain does the malware connect to?  
- What port is used for C2 communication?  
- List 3 suspicious strings that suggest malicious intent.  

---

### **Part 2: Ghidra Analysis**  
**Task 2: Import into Ghidra**  
1. Create a new project and import `sample`  
2. Analyze with default settings  

**Task 3: Identify Key Functions**  
1. Look for the `main` function in the Symbol Tree  
2. Trace function calls to identify:  
   - Network connections
   - process creation 
   - any other suspicious activity 
3. Find the hardcoded domain and port in the decompiled code  

**Task**:  
- Label all functions in the binary in ghidra. Give them sensible names. 
---


### **Part 3: Malware Classification**  
1. What type of malware is this?  
2. What do you think it is used for
3. Who do you think it is targeting?
4. How sophisticated do you think this actor is?

